<import src="../../common/page_loading.wxml"/>

<nav isFromWeapp="{{isFromWeapp}}" title="{{navigateTitle}}" hasHeaderHeight hasShadow pageLogin="{{isLogin}}"></nav>
<view class="{{isIphoneX ? 'has-safe-padding' : ''}}">
  <view class="u-detail-padding daily__container">
    <template is="page_loading" wx:if="{{isFetching}}" />

    <view class="daily__title">{{daily.title}}</view>
    <view class="daily__create">{{daily.created_at}}</view>
    <view class="daily__content">{{daily.content}}</view>
    <view class="daily__source" wx:if="{{daily.url !== null}}">
      <image src="/icons/daily_source.png" class="daily__source--img" />
      <text>新闻来源：</text>
      <text class="daily__source--link" bindtap="copySource">{{showUrl}}</text>
    </view>
  </view>

  <view wx:if="{{!isFetching}}">
    <comment isShowComment="{{isShowComment}}" baseUrl="/dailies/{{id}}" bindclosecommentevent="closeComment" bindopencommentevent="openComment"></comment>
    <template is="comment-bottom-bar" data="{{isLogin: isLogin, isIphoneX: isIphoneX, prePath: '../../..'}}" />
    <view class="u-fix-bottom {{isIphoneX ? 'has-safe-padding' : ''}}">
      <view class="u-fix-bottom--bar" bindtap="openComment"  wx:if="{{isLogin}}">
        <image class="u-fix-bottom--icon" src="../../../icons/article_comment.png" />
        <text>评论</text>
      </view>
      <button class="u-fix-bottom--bar is-button" open-type="getUserInfo" bindgetuserinfo="getUserInfo" data-type="comment"  wx:else>
        <image class="u-fix-bottom--icon" src="../../../icons/article_comment.png" />
        <text>评论</text>
      </button>

      <navigator class="u-fix-bottom--bar" url="/pages/daily/screenshot/screenshot?id={{daily.id}}" hover-class="none">
        <image class="u-fix-bottom--icon" src="../../../icons/article_shared.png" />
        <text>分享</text>
      </navigator>
    </view>
  </view>
  <settingEntry hasComment pageLogin="{{isLogin}}"></settingEntry>
</view>
